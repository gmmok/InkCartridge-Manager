## 项目技术分析

### 开发框架与环境

该项目是使用 .NET Framework 开发的 WPF 应用程序。根据项目文件和引用的包，该项目使用的是 .NET Framework 4.7.2 进行开发，采用MVVM架构模式。

### 主要技术特点

1. **MVVM架构** - 清晰分离视图、视图模型和模型层
2. **数据绑定** - 使用WPF强大的数据绑定功能实现UI与数据的同步
3. **本地化支持** - 通过LocalizationHelper实现多语言支持
4. **数据可视化** - 使用LiveCharts实现直观的图表显示
5. **响应式UI** - 动态适应数据变化和用户交互
6. **SQLite数据库** - 轻量级本地数据存储解决方案

### 代码架构

1. **Models** - 包含业务实体类（Cartridge, CartridgeColor, StockRecord等）
2. **Views** - 用户界面实现（DashboardPage, CartridgeManagePage等）
3. **Utils** - 工具类（DatabaseHelper, LocalizationHelper等）
4. **Interfaces** - 定义系统接口（IRefreshable等）

### 部署方式

1. 克隆或下载本仓库代码

2. 使用Visual Studio 2019或更高版本打开解决方案文件（爱普生墨盒管理系统.sln）

3. 还原NuGet包

   或自行安装NuGet包：

   - System.Data.SQLite (1.0.118.0+)
   - EPPlus (7.7.0+)
   - LiveCharts (0.9.7+)
   - LiveCharts.Wpf (0.9.7+)

4. 编译并运行项目

# 宽幅面墨盒管理系统

## 项目介绍

本软件主要针对打印机墨盒进行全生命周期管理，包括入库、出库、库存监控和使用统计等功能，帮助用户高效管理打印耗材资源，降低运营成本。系统专为爱普生等宽幅面打印机墨盒设计，支持多种型号和颜色的墨盒管理。

## 功能特点

### 墨盒信息管理

- 支持管理各种不同颜色墨盒，每种颜色对应N个不同墨盒型号
- 墨盒基本信息维护（颜色、型号、库存警戒线等）
- 自定义墨盒型号添加功能
- 直观的颜色显示，墨盒颜色与实际颜色一致

### 库存操作

- 墨盒入库登记
- 墨盒出库管理
- 库存自动更新
- 批量操作支持

### 库存监控

- 实时库存状态可视化展示
- 库存不足智能预警（基于可自定义的警戒线）
- 库存状态颜色编码直观显示
- 柱状图展示各颜色墨盒库存情况

### 数据查询与统计

- 多条件组合查询（按颜色、型号、日期等）
- 进出库历史记录查询
- 墨盒使用频率统计
- 各颜色墨盒消耗趋势分析
- 按项目统计墨盒消耗情况

### 报表功能

- 月度/季度/年度用量报表
- 支持导出Excel格式报表
- 自定义报表生成
- 数据可视化展示

### 系统管理

- 系统设置
- 数据备份与恢复

## 系统要求

- 操作系统：Windows 7/8/10/11
- .NET Framework 4.7.2或更高版本
- 屏幕分辨率：1366×768或更高
- 硬盘空间：至少100MB可用空间
- SQLite支持（自动初始化生成）

## 使用说明

### 首次使用

1. 首次启动系统时，会自动初始化SQLiteDB.sql数据库（默认是爱普生11色墨盒）
2. 可在设置页面配置数据库备份路径和基本参数
3. 在墨盒管理页面添加墨盒基础数据
4. 修改不同型号打印机墨盒数据信息，在软件根目录下编辑SQLiteDB.sql数据库初始化文件，对应修改CartridgeColors表信息

### 日常操作流程

1. **墨盒入库**：在"入库"页面记录新墨盒入库信息
   - 选择墨盒颜色和型号
   - 输入入库数量
   - 添加备注信息（可选）
   - 点击确认完成入库

2. **墨盒出库**：在"出库"页面登记墨盒出库信息
   - 选择墨盒颜色和型号
   - 输入出库数量
   - 选择出库项目
   - 添加操作人员信息
   - 点击确认完成出库

3. **库存查询**：在"库存查询"页面查看当前库存状态
   - 支持按颜色筛选
   - 支持模糊搜索
   - 红色标识库存不足的墨盒
   - 点击刷新按钮更新数据

4. **数据统计**：在"报表"页面生成各类统计报表
   - 选择报表类型（墨盒使用统计/项目使用统计）
   - 设置时间范围
   - 点击生成报表
   - 导出Excel表格（可选）

### 警戒线设置说明

- 警戒线为1时：当墨盒库存等于1时会显示"库存不足"预警
- 警戒线为0时：只有当墨盒库存为0时才会显示"无库存"预警
- 建议根据不同墨盒使用频率设置合理的警戒线

### 注意事项

- 数据库备份，备份文件存储在应用程序目录下的"Backup"文件夹中（可修改）
- 库存低于警戒线的墨盒会在仪表盘上以红色标识
- 添加其他机型墨盒信息。首先删除软件根目录下的CartridgeDB.db数据库文件。自行修改软件根目录下的SQLiteDB.sql表CartridgeColors里边的VALUES值，默认是11种颜色。
- 定期备份数据库文件，避免数据丢失
- 操作出错后可查看控制台日志信息

## 常见问题

**Q: 如何添加新的墨盒型号？**  
A: 在"墨盒管理"页面点击"添加新墨盒"按钮，填写相关信息后保存即可。
注：这里可以添加每个墨盒大小型号，容量不同的信息，但是颜色名称必须一致。主界面才能显示该墨盒总数。

**Q: 如何修改库存警戒线？**  
A: 在"墨盒管理"页面选择需要修改的墨盒，点击"编辑"按钮，修改警戒线数值后保存。

**Q: 如何导出报表数据？**  
A: 在"报表"页面生成所需报表后，点击"导出"按钮，选择保存路径即可导出Excel格式报表。

**Q: 柱状图上的数据不显示或显示不全怎么办？**  
A: 点击"全部显示"按钮可刷新图表数据。如果问题仍然存在，尝试调整窗口大小或重启应用。

**Q: 数据库损坏怎么恢复？**  
A: 在"设置"页面中，使用"恢复数据库"功能选择之前的备份文件进行恢复。如无备份，可尝试使用"压缩数据库"功能修复轻微损坏。

## 技术支持

- 无

## 版权信息

- 无